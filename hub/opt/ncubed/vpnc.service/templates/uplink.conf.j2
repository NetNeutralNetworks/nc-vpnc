connections {
    # Section for an IKE connection named <conn>.
{%- for conn in connections %}
    {{ conn.remote }}-{{ conn.t_id }} : default-uplinks {
        # Remote address(es) to use for IKE communication, comma separated.
        remote_addrs = {{ conn.remote_peer_ip }}
        # Default inbound XFRM interface ID for children.
        if_id_in = 0x{{ conn.xfrm_id }}
        # Default outbound XFRM interface ID for children.
        if_id_out = 0x{{ conn.xfrm_id }}
    }
{%- endfor %}
}

secrets {
{%- for conn in connections %}
    ike-{{ conn.remote }}-{{ conn.t_id }} {
        secret = "{{ conn.psk }}"
    }
{%- endfor %}
}
